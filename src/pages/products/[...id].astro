---
import type { GetStaticPaths } from "astro";
import Layout from "@/layouts/Layout.astro";
import { products } from "@db";
import Catalog from "@/components/Catalog.astro";
import ProductSection from "@/components/ProductSection.astro";

export const getStaticPaths = (() => {
  return products.map((product) => {
    return {
      params: { id: product.id },
      props: { product },
    };
  });
}) satisfies GetStaticPaths;

const { id } = Astro.params;
const { product } = Astro.props;

export const prerender = true;
---

<Layout title={product.name}>
  <ProductSection {product} />
  <h2>Related Products</h2>
  <Catalog {products} excludeId={product.id} />
</Layout>
